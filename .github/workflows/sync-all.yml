name: 自动同步（原仓库→当前仓库→Gitee）
on:
  schedule:
    - cron: '0 18 * * *' # 每天UTC18点=北京时间凌晨2点
  workflow_dispatch: # 新增：允许手动触发（核心！用于测试）

jobs:
  # 步骤1：同步原GitHub仓库
  sync-upstream:
    uses: longzai2651/sync-template/.github/workflows/_sync-upstream.yml@main
    with:
      ## 原仓库地址 ## https://github.com/6dylan6/jdpro.git
      upstream-repo: "https://github.com/6dylan6/jdpro.git" 
      branch: "main" # 同步的分支

  # 步骤2：同步到Gitee（依赖步骤1完成）
  sync-to-gitee:
    needs: sync-upstream
    uses: longzai2651/sync-template/.github/workflows/_sync-to-gitee.yml@main
    with:
      ## Gitee仓库 ###################
      gitee-repo: "longzai2651/jdpro" 
      gitee-username: "longzai2651" # 你的Gitee用户名
      branch: "main"
    secrets:
      gitee-token: ${{ secrets.GITEE_TOKEN }} # 提前在该仓库配置好GITEE_TOKEN
